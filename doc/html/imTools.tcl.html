<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!-- Generated by TclDoc 0.3 -->
<html>
<head><title>imTools.tcl</title></head>
<body bgcolor="#ffffff">
<font size="-2">
<a href="xsmurf_tcl_lib_intro.html">Overview</a> | Index by:  <a href="index_main.html#imTools.tcl">file name</a> |
<a href="index_main.html#byprocname">procedure name</a> |
<a href="index_main.html#bycall">procedure call</a> |
<a href="index_annot_full.html">annotation</a>
</font>
<hr>
<strong>imTools.tcl</strong>
(<a href="imTools.tcl-annot.html">annotations</a> | <a href="imTools.tcl.txt">original source</a>)
<p>
<pre>
<font color="#208020"># imTools.tcl --</font>
<font color="#208020">#</font>
<font color="#208020">#       This file implements the Tcl code image tools.</font>
<font color="#208020">#</font>
<font color="#208020">#   Copyright 1998 Centre de Recherche Paul Pascal, Bordeaux, France.</font>
<font color="#208020">#   Written by Nicolas Decoster.</font>
<font color="#208020">#</font>
<font color="#208020">#  RCS : $Id: imTools.tcl,v 1.1 1999/07/09 15:14:41 decoster Exp $</font>
<font color="#208020">#</font>

package provide imTools


<font color="#208020"># imoment --</font>
<font color="#208020"># usage: imoment Image int</font>
<font color="#208020">#</font>
<font color="#208020">#   Compute a given moment of an image.</font>
<font color="#208020">#</font>
<font color="#208020"># Parameters:</font>
<font color="#208020">#   Image   - Image to treat.</font>
<font color="#208020">#   integer - Order of the moment.</font>
<font color="#208020">#</font>
<font color="#208020"># Return value:</font>
<font color="#208020">#   The moment.</font>

<strong><a name="imoment_26">proc <a href="imTools.tcl-annot.html#imoment">imoment</a></a></strong><a name="imoment"></a> {image order} {
    <a name="lassign(1)"><a href="./tools.tcl.html#lassign_67">lassign</a></a> {type lx ly min max} [iinfo $image]
    set size [expr { $lx*$ly }]

    return [expr { [ifct $image pow(x,$order)]/$size }]
}


<font color="#208020"># istats --</font>
<font color="#208020"># usage: istats Image int</font>
<font color="#208020">#</font>
<font color="#208020">#   Compute successive moments of an image.</font>
<font color="#208020">#</font>
<font color="#208020"># Parameters:</font>
<font color="#208020">#   Image   - Image to treat.</font>
<font color="#208020">#   integer - Order of the upper moment. Must be greater or equal to 2.</font>
<font color="#208020">#</font>
<font color="#208020"># Return value:</font>
<font color="#208020">#   List of the variance and of the moments.</font>

<strong><a name="istats_46">proc <a href="imTools.tcl-annot.html#istats">istats</a></a></strong><a name="istats"></a> {image order} {
    if {$order &lt; 2} {
	return -code error &#34;&#34;
    }

    for {set k 1} {$k &lt;= $order} {incr k} {
	set res [<a name="imoment(1)"><a href="./imTools.tcl.html#imoment_26">imoment</a></a> $image $k]
        lappend resLst $res
    }

    set variance [expr { sqrt([lindex $resLst 1]-pow([lindex $resLst 0],2)) }]

    return [concat $variance $resLst]
}


<font color="#208020"># correlation --</font>
<font color="#208020"># usage: correlation image image </font>
<font color="#208020">#</font>
<font color="#208020">#   Compute the correlations between 2 images. By default the mean of</font>
<font color="#208020"># each image is substracted before treatment. Both 2d and 1d</font>
<font color="#208020"># correlations can be computed. 1d correlations are an angular mean of</font>
<font color="#208020"># the 1d correlations.</font>
<font color="#208020">#</font>
<font color="#208020"># Parameters:</font>
<font color="#208020">#   2 Images - Images to treat.</font>
<font color="#208020">#</font>
<font color="#208020"># Options:</font>
<font color="#208020">#   -2d: Option to request the 2d correlations.</font>
<font color="#208020">#      string - Name of the 2d correlations image.</font>
<font color="#208020">#   -1d: Specify the name of the 1d correlations signal.</font>
<font color="#208020">#      string - The Name. Default is &#34;c_${im1}_${im2}&#34;, where im1 and</font>
<font color="#208020">#               im2 are the names of the images to treat.</font>
<font color="#208020">#   -w1: Specify the name of a precomputed image that contains the</font>
<font color="#208020">#      first image minus its mean.</font>
<font color="#208020">#   -w2: Specify the name of a precomputed image that contains the</font>
<font color="#208020">#      second image minus its mean.</font>
<font color="#208020">#   -nomean: Do not substract the mean of each images before</font>
<font color="#208020">#      treatment.</font>
<font color="#208020">#</font>
<font color="#208020"># Return value:</font>
<font color="#208020">#   Name of the 1d correlations signal.</font>

<strong><a name="correlation_89">proc <a href="imTools.tcl-annot.html#correlation">correlation</a></a></strong><a name="correlation"></a> {im1 im2 args} {
    set sigName c_${im1}_${im2}
    set imName __imRes
    set w1Name __w1
    set w2Name __w2
    set isNomean no

    <font color="#208020"># Arguments analysis</font>

    set oldArgs $args
    while {[string match -* $args]} {
	switch -exact -- [lindex $args 0] {
	    -2d {
		set imName [lindex $args 1]
		set args [lreplace $args 0 1]
	    }
	    -1d {
		set sigName [lindex $args 1]
		set args [lreplace $args 0 1]
	    }
	    -w1 {
		set w1Name [lindex $args 1]
		set args [lreplace $args 0 1]
	    }
	    -w2 {
		set w2Name [lindex $args 1]
		set args [lreplace $args 0 1]
	    }
	    -nomean {
		set isNomean yes
		set args [lreplace $args 0 0]
	    }
	    --  {
		set args [lreplace $args 0 0]
		break
	    }
	    default {
		return -code error &#34;unknown option \&#34;[lindex $args 0]\&#34;&#34;
	    }
	}
    }

    if {$isNomean == &#34;no&#34;} {
	if {[string compare $w1Name &#34;__w1&#34;] == 0 \
		|| [catch [list ginfo $w1Name]] == 1} {
	    set mean [<a name="imoment(2)"><a href="./imTools.tcl.html#imoment_26">imoment</a></a> $im1 1]
	    icomb $im1 $im1 x-$mean $w1Name
	}

	if {[string compare $w2Name &#34;__w2&#34;] == 0 \
		|| [catch [list ginfo $w2Name]] == 1} {
	    set mean [<a name="imoment(3)"><a href="./imTools.tcl.html#imoment_26">imoment</a></a> $im2 1]
	    icomb $im2 $im2 x-$mean $w2Name
	}
    } else {
	set w1Name $im1
	set w2Name $im2
    }

    <a name="lassign(2)"><a href="./tools.tcl.html#lassign_67">lassign</a></a> {type lx ly min max} [iinfo $im1]
    set size [expr { [im_size $im1]/2 }]
    
    set nbOfPoints [expr { $lx*$ly }]

    iinvert $w1Name __tmp
    cv2dn __tmp $w2Name $imName -ft -0p
    icomb $imName $imName x/$nbOfPoints $imName
    iangularmean $imName $sigName $size

    catch {delete __tmp}
    catch {delete __imRes}
    catch {delete __w1}
    catch {delete __w2}

    return $sigName
}

<font color="#208020"># iexists --</font>
<font color="#208020"># usage: iexists string</font>
<font color="#208020">#</font>
<font color="#208020">#   Check the existence of an image.</font>
<font color="#208020">#</font>
<font color="#208020"># Parameters:</font>
<font color="#208020">#   string - Name of the image to check.</font>
<font color="#208020">#</font>
<font color="#208020"># Return value:</font>
<font color="#208020">#   1 if the image exists, 0 otherwise.</font>

<strong><a name="iexists_177">proc <a href="imTools.tcl-annot.html#iexists">iexists</a></a></strong><a name="iexists"></a> {im} {
    set code [catch [list iinfo $im]]

    if {$code == 0} {
	return 1
    } else {
	return 0
    }
}

</pre>
<hr>
<font size="-2">
<a href="xsmurf_tcl_lib_intro.html">Overview</a> | Index by:  <a href="index_main.html#byfilename">file name</a> |
<a href="index_main.html#byprocname">procedure name</a> |
<a href="index_main.html#bycall">procedure call</a> |
<a href="index_annot_full.html">annotation</a><br>
<cite>File generated 2008-04-03 at 09:49.</cite>
</font>
</body>
</html>
