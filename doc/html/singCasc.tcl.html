<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!-- Generated by TclDoc 0.3 -->
<html>
<head><title>singCasc.tcl</title></head>
<body bgcolor="#ffffff">
<font size="-2">
<a href="xsmurf_tcl_lib_intro.html">Overview</a> | Index by:  <a href="index_main.html#singCasc.tcl">file name</a> |
<a href="index_main.html#byprocname">procedure name</a> |
<a href="index_main.html#bycall">procedure call</a> |
<a href="index_annot_full.html">annotation</a>
</font>
<hr>
<strong>singCasc.tcl</strong>
(<a href="singCasc.tcl-annot.html">annotations</a> | <a href="singCasc.tcl.txt">original source</a>)
<p>
<pre>
<font color="#208020"># singCasc.tcl --</font>
<font color="#208020">#</font>
<font color="#208020">#       This file implements the Tcl code for singular cascade images</font>
<font color="#208020"># manipulation.</font>
<font color="#208020">#</font>
<font color="#208020">#   Copyright 1999 Centre de Recherche Paul Pascal, Bordeaux, France.</font>
<font color="#208020">#   Written by Nicolas Decoster.</font>
<font color="#208020">#</font>
<font color="#208020">#  RCS : $Id$</font>
<font color="#208020">#</font>

package provide singCasc

<font color="#208020"># scGetTauEps --</font>
<font color="#208020"># usage: scGetTauEps string real real real [real]</font>
<font color="#208020">#</font>
<font color="#208020">#   Create a signal that contains the theoretical tau(q) specrtum of a 2D</font>
<font color="#208020"># singular cascade (p-model). </font>
<font color="#208020">#</font>
<font color="#208020"># Arguments:</font>
<font color="#208020">#   string - Name of the result.</font>
<font color="#208020">#   real   - Value of p. Must be 0 &lt;= p &lt; 1/2.</font>
<font color="#208020">#   real   - First value of q.</font>
<font color="#208020">#   real   - Last value of q.</font>
<font color="#208020">#   real   - Value of the dq. Default is 0.1.</font>
<font color="#208020">#</font>
<font color="#208020"># Return value:</font>
<font color="#208020">#   Name of the result.</font>

<strong><a name="scGetTauEps_30">proc <a href="singCasc.tcl-annot.html#scGetTauEps">scGetTauEps</a></a></strong><a name="scGetTauEps"></a> {sig p qMin qMax {dx 0.1}} {
    if {$p &lt; 0 || $p &gt;= 0.5} {
	return -code error &#34;p must be 0 &lt;= p &lt; 1/2&#34;
    }

    set n [expr { int(($qMax - $qMin)/$dx + 1) }]
    exprr $sig -1-log(pow(2*$p,x)+pow(2-2*$p,x))/log(2) $qMin $qMax $n

    return $sig
}


<font color="#208020"># scGetDEps --</font>
<font color="#208020"># usage: scGetDEps string real real real [real]</font>
<font color="#208020">#</font>
<font color="#208020">#   Create a signal that contains the theoretical D(h) specrtum of a 2D</font>
<font color="#208020"># singular cascade (p-model). This spectrum is computing using a legendre</font>
<font color="#208020"># transform of tau(q).</font>
<font color="#208020">#</font>
<font color="#208020"># Arguments:</font>
<font color="#208020">#   string - Name of the result.</font>
<font color="#208020">#   real   - Value of p. Must be 0 &lt;= p &lt; 1/2.</font>
<font color="#208020">#   real   - First value of q.</font>
<font color="#208020">#   real   - Last value of q.</font>
<font color="#208020">#   real   - Value of the dq. Default is 0.1.</font>
<font color="#208020">#</font>
<font color="#208020"># Return value:</font>
<font color="#208020">#   Name of the result.</font>

<strong><a name="scGetDEps_59">proc <a href="singCasc.tcl-annot.html#scGetDEps">scGetDEps</a></a></strong><a name="scGetDEps"></a> {sig p qMin qMax {dx 0.1}} {
    if {$p &lt; 0 || $p &gt;= 0.5} {
	return -code error &#34;p must be 0 &lt;= p &lt; 1/2&#34;
    }

    <a name="scGetTauEps(1)"><a href="./singCasc.tcl.html#scGetTauEps_30">scGetTauEps</a></a> $sig $p $qMin $qMax $dx
    <a name="legendre(1)"><a href="./legendre.tcl.html#legendre_28">legendre</a></a> $sig 3 $sig
 
    return $sig
}


<font color="#208020"># scGetTau --</font>
<font color="#208020"># usage: scGetTau string real real real real [real]</font>
<font color="#208020">#</font>
<font color="#208020">#   Create a signal that contains the theoretical tau(q) specrtum of a 2D</font>
<font color="#208020"># singular cascade (p-model) with a fractionnary integration. </font>
<font color="#208020">#</font>
<font color="#208020"># Arguments:</font>
<font color="#208020">#   string - Name of the result.</font>
<font color="#208020">#   real   - Value of p. Must be 0 &lt;= p &lt; 1/2.</font>
<font color="#208020">#   real   - H* of the integration.</font>
<font color="#208020">#   real   - First value of q.</font>
<font color="#208020">#   real   - Last value of q.</font>
<font color="#208020">#   real   - Value of the dq. Default is 0.1.</font>
<font color="#208020">#</font>
<font color="#208020"># Return value:</font>
<font color="#208020">#   Name of the result.</font>

<strong><a name="scGetTau_88">proc <a href="singCasc.tcl-annot.html#scGetTau">scGetTau</a></a></strong><a name="scGetTau"></a> {sig p Hstar qMin qMax {dx 0.1}} {
    if {$p &lt; 0 || $p &gt;= 0.5} {
	return -code error &#34;p must be 0 &lt;= p &lt; 1/2&#34;
    }

    <a name="scGetTauEps(2)"><a href="./singCasc.tcl.html#scGetTauEps_30">scGetTauEps</a></a> $sig $p $qMin $qMax $dx
    s2fs $sig $sig x y+$Hstar*x

    return $sig
}


<font color="#208020"># scGetD --</font>
<font color="#208020"># usage: scGetD string real real real real [real]</font>
<font color="#208020">#</font>
<font color="#208020">#   Create a signal that contains the theoretical D(h) specrtum of a 2D singular</font>
<font color="#208020"># cascade (p-model) with a fractionnary integration. This spectrum is computing</font>
<font color="#208020"># using a legendre transform of tau(q).</font>
<font color="#208020">#</font>
<font color="#208020"># Arguments:</font>
<font color="#208020">#   string - Name of the result.</font>
<font color="#208020">#   real   - Value of p. Must be 0 &lt;= p &lt; 1/2.</font>
<font color="#208020">#   real   - H* of the integration.</font>
<font color="#208020">#   real   - First value of q.</font>
<font color="#208020">#   real   - Last value of q.</font>
<font color="#208020">#   real   - Value of the dq. Default is 0.1.</font>
<font color="#208020">#</font>
<font color="#208020"># Return value:</font>
<font color="#208020">#   Name of the result.</font>

<strong><a name="scGetD_118">proc <a href="singCasc.tcl-annot.html#scGetD">scGetD</a></a></strong><a name="scGetD"></a> {sig p Hstar qMin qMax {dx 0.1}} {
    if {$p &lt; 0 || $p &gt;= 0.5} {
	return -code error &#34;p must be 0 &lt;= p &lt; 1/2&#34;
    }

    <a name="scGetTau(1)"><a href="./singCasc.tcl.html#scGetTau_88">scGetTau</a></a> $sig $p $Hstar $qMin $qMax $dx
    <a name="legendre(2)"><a href="./legendre.tcl.html#legendre_28">legendre</a></a> $sig 3 $sig
 
    return $sig
}


<font color="#208020"># scGetSpectra --</font>
<font color="#208020"># usage: scGetSpectra string real real real real [real]</font>
<font color="#208020">#</font>
<font color="#208020">#   Create signals that contain the theoretical spectra (tau(a) and D(h)) of a</font>
<font color="#208020"># 2D singular cascade (p-model) before _and_ after a fractionnary integration.</font>
<font color="#208020">#</font>
<font color="#208020"># Arguments:</font>
<font color="#208020">#   string - Name of the result.</font>
<font color="#208020">#   real   - Value of p. Must be 0 &lt;= p &lt; 1/2.</font>
<font color="#208020">#   real   - H* of the integration.</font>
<font color="#208020">#   real   - First value of q.</font>
<font color="#208020">#   real   - Last value of q.</font>
<font color="#208020">#   real   - Value of the dq. Default is 0.1.</font>
<font color="#208020">#</font>
<font color="#208020"># Return value:</font>
<font color="#208020">#   Name of the result.</font>

<strong><a name="scGetSpectra_147">proc <a href="singCasc.tcl-annot.html#scGetSpectra">scGetSpectra</a></a></strong><a name="scGetSpectra"></a> {baseName p Hstar qMin qMax {dx 0.1}} {
    if {$p &lt; 0 || $p &gt;= 0.5} {
	return -code error &#34;p must be 0 &lt;= p &lt; 1/2&#34;
    }

    <a name="scGetTauEps(3)"><a href="./singCasc.tcl.html#scGetTauEps_30">scGetTauEps</a></a> ${baseName}teq $p $qMin $qMax $dx
    <a name="scGetTau(2)"><a href="./singCasc.tcl.html#scGetTau_88">scGetTau</a></a> ${baseName}tq $p $Hstar $qMin $qMax $dx
    <a name="scGetDEps(1)"><a href="./singCasc.tcl.html#scGetDEps_59">scGetDEps</a></a> ${baseName}Deh $p $qMin $qMax $dx
    <a name="scGetD(1)"><a href="./singCasc.tcl.html#scGetD_118">scGetD</a></a> ${baseName}Dh $p $Hstar $qMin $qMax $dx

    return [list ${baseName}teq ${baseName}tq ${baseName}Deh ${baseName}Dh]
}


<font color="#208020"># scH2BetaPhy --</font>
<font color="#208020"># usage: scH2BetaPhy real real</font>
<font color="#208020">#</font>
<font color="#208020">#   Compute the value of beta phi. This is needed by the fortran program that</font>
<font color="#208020"># generates the 2D singular cascade + integration. This program was written by</font>
<font color="#208020"># A. Davis. ** Warning **: The fortran program need the value of beta phi - 1 (I</font>
<font color="#208020"># guess it is in memory of 1D cascades).</font>
<font color="#208020">#</font>
<font color="#208020"># Arguments:</font>
<font color="#208020">#   real   - Value of p. Must be 0 &lt;= p &lt; 1/2.</font>
<font color="#208020">#   real   - H* of the integration.</font>
<font color="#208020">#</font>
<font color="#208020"># Return value:</font>
<font color="#208020">#   Value of beta phy.</font>

<strong><a name="scH2BetaPhy_176">proc <a href="singCasc.tcl-annot.html#scH2BetaPhy">scH2BetaPhy</a></a></strong><a name="scH2BetaPhy"></a> {p Hstar} {
    if {$p &lt; 0 || $p &gt;= 0.5} {
	return -code error &#34;p must be 0 &lt;= p &lt; 1/2&#34;
    }

    set betaEps2 [expr { 1 - log(2*$p*$p - 2*$p + 1)/log(2) }]
    return [expr { 2*$Hstar + $betaEps2 }]
}


<font color="#208020"># scBetaPhy2H --</font>
<font color="#208020"># usage: scBetaPhy2H real real</font>
<font color="#208020">#</font>
<font color="#208020">#   Compute the value of H*.</font>
<font color="#208020">#</font>
<font color="#208020"># Arguments:</font>
<font color="#208020">#   real   - Value of p. Must be 0 &lt;= p &lt; 1/2.</font>
<font color="#208020">#   real   - Beta phy.</font>
<font color="#208020">#</font>
<font color="#208020"># Return value:</font>
<font color="#208020">#   Value of H*.</font>

<strong><a name="scBetaPhy2H_198">proc <a href="singCasc.tcl-annot.html#scBetaPhy2H">scBetaPhy2H</a></a></strong><a name="scBetaPhy2H"></a> {p betaPhy} {
    if {$p &lt; 0 || $p &gt;= 0.5} {
	return -code error &#34;p must be 0 &lt;= p &lt; 1/2&#34;
    }

    set betaEps2 [expr { 1 - log(2*$p*$p - 2*$p + 1)/log(2) }]
    return [expr { ($betaPhy - $betaEps2)/2 }]
}

</pre>
<hr>
<font size="-2">
<a href="xsmurf_tcl_lib_intro.html">Overview</a> | Index by:  <a href="index_main.html#byfilename">file name</a> |
<a href="index_main.html#byprocname">procedure name</a> |
<a href="index_main.html#bycall">procedure call</a> |
<a href="index_annot_full.html">annotation</a><br>
<cite>File generated 2008-04-03 at 09:49.</cite>
</font>
</body>
</html>
