<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!-- Generated by TclDoc 0.3 -->
<html>
<head><title>owt2dPkg.tcl</title></head>
<body bgcolor="#ffffff">
<font size="-2">
<a href="xsmurf_tcl_lib_intro.html">Overview</a> | Index by:  <a href="index_main.html#owt2dPkg.tcl">file name</a> |
<a href="index_main.html#byprocname">procedure name</a> |
<a href="index_main.html#bycall">procedure call</a> |
<a href="index_annot_full.html">annotation</a>
</font>
<hr>
<strong>owt2dPkg.tcl</strong>
(<a href="owt2dPkg.tcl-annot.html">annotations</a> | <a href="owt2dPkg.tcl.txt">original source</a>)
<p>
<pre>
<font color="#208020"># owt2dPkg.tcl --</font>
<font color="#208020">#</font>
<font color="#208020">#       This file implements the Tcl code for orthogonal decomposition.</font>
<font color="#208020">#</font>
<font color="#208020">#   Copyright 1999 Centre de Recherche Paul Pascal, Bordeaux, France.</font>
<font color="#208020">#   Written by Nicolas Decoster.</font>
<font color="#208020">#</font>
<font color="#208020">#  RCS : $Id: owt2dPkg.tcl,v 1.4 1999/06/25 20:25:44 decoster Exp $</font>
<font color="#208020">#</font>

package provide owt2d 0.0

package require lwPkg 0.0

<font color="#208020"># o2load --</font>
<font color="#208020"># usage: o2load string int</font>
<font color="#208020">#</font>
<font color="#208020">#   Load all the images corresponding to a orthogonal decomposition.</font>
<font color="#208020">#</font>
<font color="#208020"># Arguments:</font>
<font color="#208020">#   string  - Base name of the files.</font>
<font color="#208020">#   integer - Number of octaves used for the decomposition.</font>
<font color="#208020">#</font>
<font color="#208020"># Return value:</font>
<font color="#208020">#   None.</font>

<strong><a name="o2load_27">proc <a href="owt2dPkg.tcl-annot.html#o2load">o2load</a></a></strong><a name="o2load"></a> {name nOct} {
    for {set i 1} {$i &lt;= $nOct} {incr i} {
	iload ${name}_x_$i
	iload ${name}_y_$i
	iload ${name}_xy_$i
    }
    return
}


<font color="#208020"># o22im --</font>
<font color="#208020"># usage: o22im string int [-load]</font>
<font color="#208020">#</font>
<font color="#208020">#   Create ane image that contains all the images corresponding to a orthogonal</font>
<font color="#208020"># decomposition.</font>
<font color="#208020">#</font>
<font color="#208020"># Arguments:</font>
<font color="#208020">#   string  - Base name of the files. This will be used for the name of the new</font>
<font color="#208020">#             image.</font>
<font color="#208020">#   integer - Number of octaves used for the decomposition.</font>
<font color="#208020">#</font>
<font color="#208020"># Options:</font>
<font color="#208020">#   -load : Load all the images before inserting.</font>
<font color="#208020">#</font>
<font color="#208020"># Return value:</font>
<font color="#208020">#   Name of the image.</font>

<strong><a name="o22im_54">proc <a href="owt2dPkg.tcl-annot.html#o22im">o22im</a></a></strong><a name="o22im"></a> {name nOct args} {
    set isLoad 0
    while {[string match -* $args]} {
	switch -glob -- [lindex $args 0] {
	    -load {
		set isLoad 1
		set args [lreplace $args 0 0]
	    }
	    default {
		return -code error &#34;unknown option \&#34;[lindex $args 0]\&#34;&#34;
	    }
	}
    }

    if {$isLoad == 1} {
	<a name="o2load(1)"><a href="./owt2dPkg.tcl.html#o2load_27">o2load</a></a> $name $nOct
    }

    set resName ${name}_o2
    set size [expr { 2*[lindex [iinfo ${name}_x_1] 1] }]
    inull $resName $size
    for {set i 1} {$i &lt;= $nOct} {incr i} {
	set size [expr { [lindex [iinfo ${name}_x_$i] 1] }]
	iinsert $resName ${name}_x_$i $size 0
	iinsert $resName ${name}_y_$i 0 $size
	iinsert $resName ${name}_xy_$i $size $size
    }

    return $resName
}


<font color="#208020"># o2dec --</font>
<font color="#208020"># usage: o2dec string integer [-resname string]</font>
<font color="#208020">#</font>
<font color="#208020">#   Ask last wave ( (c) E. Bacry ) to compute an orthogonal decomposition on an</font>
<font color="#208020"># image. The image must exist on disk.</font>
<font color="#208020">#</font>
<font color="#208020"># Arguments:</font>
<font color="#208020">#   string  - Image file name..</font>
<font color="#208020">#   integer - Number of octaves used for the decomposition.</font>
<font color="#208020">#</font>
<font color="#208020"># Options:</font>
<font color="#208020">#   -resname :</font>
<font color="#208020">#      string - Base name of the resulting files.</font>
<font color="#208020">#</font>
<font color="#208020"># Return value:</font>
<font color="#208020">#   List of the orthogonal decomposition files.</font>

<strong><a name="o2dec_103">proc <a href="owt2dPkg.tcl-annot.html#o2dec">o2dec</a></a></strong><a name="o2dec"></a> {name nOct args} {
    set wavelet Daub8
    set resName $name

    while {[string match -* $args]} {
	switch -glob -- [lindex $args 0] {
	    -resname {
		set resName [lindex $args 1]
		set args [lreplace $args 0 1]
	    }
	    default {
		return -code error &#34;unknown option \&#34;[lindex $args 0]\&#34;&#34;
	    }
	}
    }

    if {[file isfile $name] == 0} {
	return -code error &#34;can't read \&#34;$name\&#34;: no such file&#34;
    }
    if {[file isdirectory [file dirname $resName]] == 0} {
	return -code error &#34;can't write in \&#34;[file dirname $resName]\&#34;: no such directory&#34;
    }

    <a name="scr4lw(1)"><a href="./lwPkg.tcl.html#scr4lw_33">scr4lw</a></a> {
	a2
	iread 0 @$name@ -c
	owt2f @$wavelet@
	owt2d @$nOct@
	for {set i 1} {$i &lt;= @$nOct@} {incr i} {
	    set numx [= ($i)*10+1]
	    set numy [= ($i)*10+2]
	    set numxy [= ($i)*10+3]
	    iwrite $numx @$resName@_x_$i -c
	    iwrite $numy @$resName@_y_$i -c
	    iwrite $numxy @$resName@_xy_$i -c
	}
    }

    set fileLst {}
    for {set i 1} {$i &lt;= $nOct} {incr i} {
	set zeName ${resName}_x_$i
	if {[file exists $zeName] == 0} {
	    return -code error &#34;an error has occured during last wave script execution: file \&#34;$zeName\&#34; doesn't exists&#34;
	}
	lappend fileLst $zeName

	set zeName ${resName}_y_$i
	if {[file exists $zeName] == 0} {
	    return -code error &#34;an error has occured during last wave script execution: file \&#34;$zeName\&#34; doesn't exists&#34;
	}
	lappend fileLst $zeName

	set zeName ${resName}_xy_$i
	if {[file exists $zeName] == 0} {
	    return -code error &#34;an error has occured during last wave script execution: file \&#34;$zeName\&#34; doesn't exists&#34;
	}
	lappend fileLst $zeName
    }

    return $fileLst
}


<font color="#208020"># o2lnc --</font>
<font color="#208020"># usage: o2lnc string integer float float float float float</font>
<font color="#208020">#</font>
<font color="#208020">#   Ask last wave ( (c) E. Bacry ) to create a log-normal cascade using</font>
<font color="#208020"># orthogonal wavelet base. For now the best help you can find is in reading the</font>
<font color="#208020"># source code of the algorithm in LastWave.</font>
<font color="#208020">#</font>
<font color="#208020"># Arguments:</font>
<font color="#208020">#   string  - Result image file name </font>
<font color="#208020">#             (saved in current directory in PGM file format) ...</font>
<font color="#208020">#   integer - Number of octaves used for the cascade.</font>
<font color="#208020">#   float   - Constant for the scale function (at the highest scale).</font>
<font color="#208020">#   float   - Constant for the X wavelet function (at the highest scale).</font>
<font color="#208020">#   float   - Constant for the Y wavelet function (at the highest scale).</font>
<font color="#208020">#   float   - Constant for the XY wavelet function (at the highest scale).</font>
<font color="#208020">#   float   - Squared sigma of the log-normal process.</font>
<font color="#208020">#   float   - Mean of the log-normal process.</font>
<font color="#208020">#   float   - dTheta1: variation of theta1. theta1 in [-dTheta1/2,dTheta1/2].</font>
<font color="#208020">#             Theta1 is the angle between the XY wavelet axe and the</font>
<font color="#208020">#             (X wavelet, Y wavelet) plan. Very special behavior if dTheta1</font>
<font color="#208020">#             is &lt; 0: we don't want to fill the X and Y components, and the XY</font>
<font color="#208020">#             components is randomly positive or negative.</font>
<font color="#208020">#</font>
<font color="#208020">#  example of parameters :</font>
<font color="#208020">#    o2lnc res.pgm 10 0 1 1 0.59460355750 0.005 -0.35157359 1.482</font>
<font color="#208020">#    see file : /user41/decoster/soutenance/figures/04/targets.tcl !!!</font>
<font color="#208020">#</font>
<font color="#208020"># Return value:</font>
<font color="#208020">#   Result file name.</font>

<strong><a name="o2lnc_196">proc <a href="owt2dPkg.tcl-annot.html#o2lnc">o2lnc</a></a></strong><a name="o2lnc"></a> {resName nOct c0 dx dy dxy sigma2 mean dTheta1 args} {
    set wavelet Daub8
    set isOnlyx 0

    if {[string compare $args &#34;&#34;] != 0} {
	switch -glob -- [lindex $args 0] {
	    -x {
		set isOnlyx 1
		set args [lreplace $args 0 0]
	    }
	    default {
		return -code error &#34;unknown option \&#34;[lindex $args 0]\&#34;&#34;
	    }
	}
    }

    <a name="scr4lw(2)"><a href="./lwPkg.tcl.html#scr4lw_33">scr4lw</a></a> {
	a2
	owt2f Daub8
	set seed [= int(urand*100000)]
	image new kk
	<font color="#208020">#owcantrn 0 10 0 1 0 0 0.044 -.4 0.0 $seed</font>
	owcantrn 0 kk @$nOct@ @$c0@ @$dx@ @$dy@ @$dxy@ @$sigma2@ @$mean@ 0.0 $seed @$dTheta1@ @$isOnlyx@
	iwrite 0 @$resName@  -h
    }
    
    <font color="#208020">#example </font>
    <font color="#208020">#owcantrn 0 8 0 1 1 0.59460355750 0.005 -0.35157359 0.0 8703 1.482 0</font>
    <font color="#208020">#owcantrn 0a2 1a2 8 0 1 1 0.59460355750 0.005 -0.35157359 0.0 8703 1.482 0</font>

    return $resName
}


<font color="#208020"># o2lpc --</font>
<font color="#208020"># usage: o2lnc string integer float float float float float float</font>
<font color="#208020">#</font>
<font color="#208020">#   Ask last wave ( (c) E. Bacry ) to create a log-Poisson cascade using</font>
<font color="#208020"># orthogonal wavelet base.</font>
<font color="#208020">#</font>
<font color="#208020"># Arguments:</font>
<font color="#208020">#   string  - Result image file name..</font>
<font color="#208020">#   integer - Number of octaves used for the cascade.</font>
<font color="#208020">#   float   - Constant for the scale function (at the highest scale).</font>
<font color="#208020">#   float   - Constant for the X wavelet function (at the highest scale).</font>
<font color="#208020">#   float   - Constant for the Y wavelet function (at the highest scale).</font>
<font color="#208020">#   float   - Constant for the XY wavelet function (at the highest scale).</font>
<font color="#208020">#   float   - Beta.</font>
<font color="#208020">#   float   - Gamma.</font>
<font color="#208020">#   float   - Lambda.</font>
<font color="#208020">#   float - Intervall of delta theta.</font>
<font color="#208020">#</font>
<font color="#208020"># Return value:</font>
<font color="#208020">#   Result name.</font>

<strong><a name="o2lpc_251">proc <a href="owt2dPkg.tcl-annot.html#o2lpc">o2lpc</a></a></strong><a name="o2lpc"></a> {resName nOct c0 dx dy dxy beta gamma lambda theta args} {
    set wavelet Daub8

    while {[string match -* $args]} {
	switch -glob -- [lindex $args 0] {
	    default {
		return -code error &#34;unknown option \&#34;[lindex $args 0]\&#34;&#34;
	    }
	}
    }

    <a name="scr4lw(3)"><a href="./lwPkg.tcl.html#scr4lw_33">scr4lw</a></a> {
	a2
	owt2f Daub8
	set seed [= int(urand*100000)]
	owcantrp 0 @$nOct@ @$c0@ @$dx@ @$dy@ @$dxy@ @$beta@ @$gamma@ @$lambda@ $seed @$theta@
	iwrite 0 @$resName@ -x
    }

    return $resName
}

</pre>
<hr>
<font size="-2">
<a href="xsmurf_tcl_lib_intro.html">Overview</a> | Index by:  <a href="index_main.html#byfilename">file name</a> |
<a href="index_main.html#byprocname">procedure name</a> |
<a href="index_main.html#bycall">procedure call</a> |
<a href="index_annot_full.html">annotation</a><br>
<cite>File generated 2008-04-03 at 09:49.</cite>
</font>
</body>
</html>
