<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!-- Generated by TclDoc 0.3 -->
<html>
<head><title>lwPkg.tcl</title></head>
<body bgcolor="#ffffff">
<font size="-2">
<a href="xsmurf_tcl_lib_intro.html">Overview</a> | Index by:  <a href="index_main.html#lwPkg.tcl">file name</a> |
<a href="index_main.html#byprocname">procedure name</a> |
<a href="index_main.html#bycall">procedure call</a> |
<a href="index_annot_full.html">annotation</a>
</font>
<hr>
<strong>lwPkg.tcl</strong>
(<a href="lwPkg.tcl-annot.html">annotations</a> | <a href="lwPkg.tcl.txt">original source</a>)
<p>
<pre>
<font color="#208020"># lwPkg.tcl --</font>
<font color="#208020">#</font>
<font color="#208020">#       Interface with last wave.</font>
<font color="#208020">#</font>
<font color="#208020">#   Copyright 1999 Centre de Recherche Paul Pascal, Bordeaux, France.</font>
<font color="#208020">#   Written by Nicolas Decoster.</font>
<font color="#208020">#</font>
<font color="#208020">#  RCS : $Id: lwPkg.tcl,v 1.5 1999/06/25 19:58:43 decoster Exp $</font>
<font color="#208020">#</font>

package provide lwPkg 0.0

namespace eval lwPkg {
    variable lwPath /home/pkestene/install/LastWave/LastWave-1.7/bin/lw
    <font color="#208020">#variable lwPath /home/kestener/install/LastWave//LastWave_nicolas/bin/lw</font>
    variable tmpFile /home/pkestene/tmp/_delete_me_scr4lw_[pid]
}

<font color="#208020"># scr4lw --</font>
<font color="#208020"># usage : scr4lw script</font>
<font color="#208020">#</font>
<font color="#208020">#   Create a file that contains a script and execute it with LastWave ( (c) E.</font>
<font color="#208020"># Bacry ).</font>
<font color="#208020">#</font>
<font color="#208020"># Arguments:</font>
<font color="#208020">#   script - The script to execute. This script is parsed before creating the</font>
<font color="#208020">#            file. Any occurence of &#34;@$varName@&#34; is replaced by the value of the</font>
<font color="#208020">#            variable &#34;varName&#34;.</font>
<font color="#208020">#</font>
<font color="#208020"># Return value:</font>
<font color="#208020">#   None.</font>

<strong><a name="scr4lw_33">proc <a href="lwPkg.tcl-annot.html#scr4lw">scr4lw</a></a></strong><a name="scr4lw"></a> {scr} {
    set zePath $lwPkg::lwPath
    set zeFile $lwPkg::tmpFile

    if {[file exists $zeFile] == 1} {
	return -code error &#34;temporary file for the script allready exists ($zeFile)&#34;
    }
    if {[file exists $zePath] == 0} {
	return -code error &#34;can't find last wave binary ($zePath)&#34;
    }

    <font color="#208020"># Parse the script to replace key words by there value.</font>

    while {[regexp {@\$([a-zA-Z0-9_]|{[.]})*@} $scr string] == 1} {
	set firstI 2
	set lastI [expr { [string length $string] - 2 }]
	set varName [string range $string $firstI $lastI]
	upvar $varName theVar
	if {[info exists theVar] == 0} {
	    return -code error &#34;can't read \&#34;$varName\&#34;: no such variable&#34;
	}
	set exp [format &#34;@\\$%s@&#34; $varName]
	regsub -all $exp $scr $theVar scr
    }

    <font color="#208020"># Create the macro file.</font>

    set f [open $zeFile w]
    puts $f $scr
    puts $f &#34;\n\nterminal eof\n&#34;
    close $f

    <font color="#208020"># Launch lw.</font>

    catch [concat exec $zePath -b &lt; $zeFile] res

    file delete $zeFile

    return
}

</pre>
<hr>
<font size="-2">
<a href="xsmurf_tcl_lib_intro.html">Overview</a> | Index by:  <a href="index_main.html#byfilename">file name</a> |
<a href="index_main.html#byprocname">procedure name</a> |
<a href="index_main.html#bycall">procedure call</a> |
<a href="index_annot_full.html">annotation</a><br>
<cite>File generated 2008-04-03 at 09:49.</cite>
</font>
</body>
</html>
