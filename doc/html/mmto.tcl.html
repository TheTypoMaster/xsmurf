<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!-- Generated by TclDoc 0.3 -->
<html>
<head><title>mmto.tcl</title></head>
<body bgcolor="#ffffff">
<font size="-2">
<a href="xsmurf_tcl_lib_intro.html">Overview</a> | Index by:  <a href="index_main.html#mmto.tcl">file name</a> |
<a href="index_main.html#byprocname">procedure name</a> |
<a href="index_main.html#bycall">procedure call</a> |
<a href="index_annot_full.html">annotation</a>
</font>
<hr>
<strong>mmto.tcl</strong>
(<a href="mmto.tcl-annot.html">annotations</a> | <a href="mmto.tcl.txt">original source</a>)
<p>
<pre>
<font color="#208020">#</font>
<font color="#208020">#   Copyright 1997 Centre de Recherche Paul Pascal, Bordeaux, France</font>
<font color="#208020">#   Written by Nicolas Decoster and Stephane Roux.</font>
<font color="#208020">#</font>
<font color="#208020">#   The author may be reached (Email) at the address</font>
<font color="#208020">#       decoster@crpp.u-bordeaux.fr</font>
<font color="#208020">#</font>

<font color="#208020">#</font>
<font color="#208020">#</font>
<strong><a name="conv_w_11">proc <a href="mmto.tcl-annot.html#conv_w">conv_w</a></a></strong><a name="conv_w"></a> {wave scale} {
    iload   im.1    IMAGE
    iconvol IMAGE $wave $scale
    fft     IMAGE -reverse
    ffttoi  IMAGE $wave
}

<font color="#208020">#</font>
<font color="#208020">#</font>
<strong><a name="conv_all_20">proc <a href="mmto.tcl-annot.html#conv_all">conv_all</a></a></strong><a name="conv_all"></a> {scale} {
    <a name="conv_w(1)"><a href="./mmto.tcl.html#conv_w_11">conv_w</a></a> dx $scale
    <a name="conv_w(2)"><a href="./mmto.tcl.html#conv_w_11">conv_w</a></a> dy $scale
    garg dx dy arg
    gmod dx dy mod
    <a name="conv_w(3)"><a href="./mmto.tcl.html#conv_w_11">conv_w</a></a> dxx $scale
    <a name="conv_w(4)"><a href="./mmto.tcl.html#conv_w_11">conv_w</a></a> dyy $scale
    <a name="conv_w(5)"><a href="./mmto.tcl.html#conv_w_11">conv_w</a></a> dxy $scale
    <a name="conv_w(6)"><a href="./mmto.tcl.html#conv_w_11">conv_w</a></a> dxxx $scale
    <a name="conv_w(7)"><a href="./mmto.tcl.html#conv_w_11">conv_w</a></a> dyyy $scale
    <a name="conv_w(8)"><a href="./mmto.tcl.html#conv_w_11">conv_w</a></a> dxxy $scale
    <a name="conv_w(9)"><a href="./mmto.tcl.html#conv_w_11">conv_w</a></a> dxyy $scale
}

<font color="#208020"># Wavelet transform of an image. Only maxima lines are kept and saved to disk.</font>
<font color="#208020"># Multi scale.</font>
<font color="#208020">#</font>
<strong><a name="mmto_37">proc <a href="mmto.tcl-annot.html#mmto">mmto</a></a></strong><a name="mmto"></a> {image amin noct nvoix} {
    itofft  $image 	IMAGE
    isave   $image im.0
    delete $image
    fft     IMAGE
    isave   IMAGE       im.1
     
    set num 0
    
    for { set oct 0;set num 0}\
	    { $oct &lt; $noct} \
	    { incr oct } {
	for {set voix 0} \
		{ $voix &lt; $nvoix } \
		{ incr voix ; incr num} {
	    set scale [expr $amin*pow(2,$oct+($voix/double($nvoix)))]
	    set scale [expr $scale*(6/0.86)]
	    <a name="dputs(1)"><a href="./new_puts.tcl.html#dputs_12">dputs</a></a> &#34;scale $scale ( $num )&#34;
	    set new_num [format &#34;%.3d&#34; $num]
	    
	    <a name="conv_all(1)"><a href="./mmto.tcl.html#conv_all_20">conv_all</a></a> $scale
	    gkapap kapap${image}${new_num} dx dxx dy dyy dxy dxxx dxxy dxyy dyyy
	    delete dxxx dxxy dxyy dyyy
	    gkapa kapa${image}${new_num} dx dxx dy dyy dxy
	    delete dx dy dxx dxy dyy
	    follow kapa${image}${new_num} kapap${image}${new_num} \
		    mod arg ${image}max$new_num $scale
	    esave ${image}max$new_num
	    delete arg mod kapa${image}${new_num} kapap${image}${new_num}
	}
    }
    delete IMAGE
    iload im.0 $image
    exec rm im.0
    exec rm im.1
}

<font color="#208020"># Wavelet transform of an image. Only maxima lines are kept and saved to disk.</font>
<font color="#208020"># Single scale.</font>
<font color="#208020">#</font>
<strong><a name="smmto_77">proc <a href="mmto.tcl-annot.html#smmto">smmto</a></a></strong><a name="smmto"></a> {image scale} {
    itofft  $image IMAGE
    isave   $image im.0
    delete $image
    fft     IMAGE
    isave   IMAGE im.1

    <a name="nputs(1)"><a href="./new_puts.tcl.html#nputs_21">nputs</a></a> &#34;scale $scale&#34;
    <a name="conv_all(2)"><a href="./mmto.tcl.html#conv_all_20">conv_all</a></a> $scale
    gkapap kapap dx dxx dy dyy dxy dxxx dxxy dxyy dyyy
    delete dxxx dxxy dxyy dyyy
    gkapa kapa dx dxx dy dyy dxy
    delete dx dy dxx dxy dyy
    follow kapa kapap mod arg ${image}max $scale
    esave ${image}max
    delete arg mod kapa kapap
	    
    delete IMAGE
    iload im.0 $image
    exec rm im.0
    exec rm im.1
}

<font color="#208020"># Only display the value of the scales for a set of value of amin, noct and</font>
<font color="#208020"># nvoix.</font>
<font color="#208020">#</font>
<strong><a name="silent_mmto_103">proc <a href="mmto.tcl-annot.html#silent_mmto">silent_mmto</a></a></strong><a name="silent_mmto"></a> {amin noct nvoix} {
    set num 0
    
    for { set oct 0;set num 0}\
	    { $oct &lt; $noct} \
	    { incr oct } {
	for {set voix 0} \
		{ $voix &lt; $nvoix } \
		{ incr voix ; incr num} {
	    set scale [expr $amin*pow(2,$oct+($voix/double($nvoix)))]
	    set scale [expr $scale*(6/0.86)]
	    puts &#34;scale $scale ( $num )&#34;
	    set new_num [format &#34;%.3d&#34; $num]
	}
    }
}

<font color="#208020"># From a WTMM, remove all maxima which modulus is under a given value.</font>
<font color="#208020">#</font>
<strong><a name="gekeep_122">proc <a href="mmto.tcl-annot.html#gekeep">gekeep</a></a></strong><a name="gekeep"></a> {max amin noct nvoix {value 0.00001}} {
    for { set oct 0;set num 0}\
	    { $oct &lt; $noct} \
	    { incr oct } {
	for {set voix 0} \
		{ $voix &lt; $nvoix } \
		{ incr voix ; incr num} {
	    set scale [expr $amin*pow(2,$oct+($voix/double($nvoix)))]
	    set scale [expr $scale*(6/0.86)]
	    <a name="dputs(2)"><a href="./new_puts.tcl.html#dputs_12">dputs</a></a> &#34;scale $scale ( $num )&#34;
	    set new_num [format &#34;%.3d&#34; $num]
	    
	    ekeep ${max}$new_num ${max}$new_num $value
	}
    }
}

<font color="#208020"># line local maxima. A REFAIRE !!!!!</font>
<font color="#208020">#</font>
<strong><a name="llm_141">proc <a href="mmto.tcl-annot.html#llm">llm</a></a></strong><a name="llm"></a> {image amin noct nvoix {box_mult 1}} {
    for { set oct 0;set num 0}\
	    { $oct &lt; $noct} \
	    { incr oct } {
	for {set voix 0} \
		{ $voix &lt; $nvoix } \
		{ incr voix ; incr num} {
	    set scale [expr $amin*pow(2,$oct+($voix/double($nvoix)))]
	    set scale [expr $scale*(6/0.86)]
	    <a name="dputs(3)"><a href="./new_puts.tcl.html#dputs_12">dputs</a></a> &#34;scale $scale ( $num )&#34;
	    set new_num [format &#34;%.3d&#34; $num]
	    set num0 [expr $num-1]
	    set new_num0 [format &#34;%.3d&#34; $num0]
	    
	    eload ${image}$new_num l$new_num
	    rm_ext l$new_num l$new_num 150 873 150 873
	    hsearch l$new_num
	    <font color="#208020">#rm_by_size l$new_num -min [expr int($scale/3)]</font>
	    eupdate l$new_num l$new_num
	    ssm l$new_num
	    if {$num == 1} {
		set box_size [expr int(log($scale)/log(2))]
		vchain l$new_num0 l$new_num $box_size 0.9 -first
	    } else {
		if {$num != 0} {
		    set box_size [expr int(log($scale)*$box_mult/log(2))]
		    puts $box_size
		    vchain l$new_num0 l$new_num $box_size 0.9
		    <font color="#208020">#l2m l$new_num0 m$new_num0</font>
		    <font color="#208020">#delete l$new_num0</font>
		    <font color="#208020">#esave m$new_num0</font>
		    <font color="#208020">#delete m$new_num0</font>
		}
	    }
	}
    }
    <font color="#208020">#l2m l000 m000</font>
    <font color="#208020">#delete l000</font>
    <font color="#208020">#esave m000</font>
    <font color="#208020">#delete m000</font>
    <font color="#208020">#l2m l$new_num m$new_num</font>
    <font color="#208020">#delete l$new_num</font>
    <font color="#208020">#esave m$new_num</font>
    <font color="#208020">#delete m$new_num</font>
    for { set oct 0;set num 0}\
	    { $oct &lt; $noct} \
	    { incr oct } {
	for {set voix 0} \
		{ $voix &lt; $nvoix } \
		{ incr voix ; incr num} {
	    set scale [expr $amin*pow(2,$oct+($voix/double($nvoix)))]
	    set scale [expr $scale*(6/0.86)]
	    <font color="#208020">#dputs &#34;scale $scale ( $num )&#34;</font>
	    set new_num [format &#34;%.3d&#34; $num]
	    set num0 [expr $num-1]
	    set new_num0 [format &#34;%.3d&#34; $num0]
	    
	    <font color="#208020">#eload l$new_num</font>
	    <font color="#208020">#el2shisto l$new_num h$new_num 32 -x 0 100</font>
	    <font color="#208020">#l2m l$new_num m$new_num</font>
	    <font color="#208020">#delete l$new_num</font>
	    <font color="#208020">#esave m$new_num</font>
	}
    }
}
</pre>
<hr>
<font size="-2">
<a href="xsmurf_tcl_lib_intro.html">Overview</a> | Index by:  <a href="index_main.html#byfilename">file name</a> |
<a href="index_main.html#byprocname">procedure name</a> |
<a href="index_main.html#bycall">procedure call</a> |
<a href="index_annot_full.html">annotation</a><br>
<cite>File generated 2008-04-03 at 09:49.</cite>
</font>
</body>
</html>
