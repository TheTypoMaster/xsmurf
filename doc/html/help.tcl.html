<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!-- Generated by TclDoc 0.3 -->
<html>
<head><title>help.tcl</title></head>
<body bgcolor="#ffffff">
<font size="-2">
<a href="xsmurf_tcl_lib_intro.html">Overview</a> | Index by:  <a href="index_main.html#help.tcl">file name</a> |
<a href="index_main.html#byprocname">procedure name</a> |
<a href="index_main.html#bycall">procedure call</a> |
<a href="index_annot_full.html">annotation</a>
</font>
<hr>
<strong>help.tcl</strong>
(<a href="help.tcl-annot.html">annotations</a> | <a href="help.tcl.txt">original source</a>)
<p>
<pre>
<font color="#208020"># help.tcl --</font>
<font color="#208020">#</font>
<font color="#208020">#       This file implements the Tcl code for help utilities.</font>
<font color="#208020">#</font>
<font color="#208020">#   Copyright 1998 Centre de Recherche Paul Pascal, Bordeaux, France.</font>
<font color="#208020">#   Written by Nicolas Decoster.</font>
<font color="#208020">#</font>
<font color="#208020">#   Copyright 1999-2007 CEA/DSM/DAPNIA/SEDI</font>
<font color="#208020">#   Modified by Pierre Kestener.</font>
<font color="#208020">#</font>

<font color="#208020"># help --</font>
<font color="#208020"># usage : help [str]</font>
<font color="#208020">#</font>
<font color="#208020">#  This procedure manage the light help utility for smurf.</font>
<font color="#208020">#</font>
<font color="#208020"># Parameters :</font>
<font color="#208020">#   string - The name of a command. This can be a C-defined command or a</font>
<font color="#208020">#            Tcl-defined procedure.</font>
<font color="#208020">#</font>
<font color="#208020"># Return value :</font>
<font color="#208020">#   A help message on the command. The definition file is return if the command</font>
<font color="#208020"># is a Tcl-defined procedure. If no command is specified, a message  with the</font>
<font color="#208020"># list of C-defined commands is return.</font>

<strong><a name="help_26">proc <a href="help.tcl-annot.html#help">help</a></a></strong><a name="help"></a> {{cmdName &#34;&#34;}} {
    global auto_index

    if {$cmdName != &#34;&#34;} {
	<font color="#208020"># Help an a given command.</font>
	set code [catch &#34;set auto_index($cmdName)&#34; result]
	if {$code} {
	    set code [catch &#34;set auto_index(::$cmdName)&#34; result]
	}
	if {$code} {
	    <font color="#208020"># cmdName is not a Tcl-defined command.</font>
	    if {[info commands $cmdName] != &#34;&#34;} {
		<font color="#208020"># cmdName is in the Tcl command hashtable.</font>

		<font color="#208020"># Set the default message.</font>
		set resStr &#34;\&#34;$cmdName\&#34; is a Tcl or a Tk command. See Tcl/Tk documentation.&#34;
		set allListOfCmds [cmdlist]
		lappend allListOfCmds [cv1d cmdlist]
		lappend allListOfCmds [cv2d cmdlist]
		foreach listOfCmds ${allListOfCmds} {
		    if {[lsearch $listOfCmds $cmdName] != -1} {
			<font color="#208020"># cmdName is in a smurf command hashtable. So we change</font>
			<font color="#208020"># the message</font>
			set resStr [$cmdName -help]
		    }
		}
	    } else {
		<font color="#208020"># cmdName is not in the Tcl command hashtable.</font>
		set resStr &#34;invalid command name \&#34;$cmdName\&#34;&#34;
	    }
	} else {
	    <font color="#208020"># cmdName is a Tcl-defined command.</font>
	    set fileName [lindex $result 1]
	    
	    <font color="#208020"># Set the default message.</font>

	    set resStr &#34;Sorry, no help for `$cmdName'.&#34;

	    <font color="#208020"># Remove leading &#34;::&#34; corresponding to package.</font>

	    regsub ^:: $cmdName {} cmdName
	    
	    <font color="#208020"># Scan all the file to find help comment on the command.</font>
	    set fileId [open $fileName r]
	    while {[gets $fileId line] != -1} {
		if {[string compare $line &#34;# $cmdName --&#34;] == 0} {
		    <font color="#208020"># header line of help comment is found.</font>
		    unset resStr
		    while {[gets $fileId line] != -1} {
			if {[regexp {^# *} $line]} {
			    <font color="#208020"># the line begins by &#34;#&#34; -&gt; it is a help comment line.</font>
			    <font color="#208020"># Remove the leading &#34;#&#34; ...</font>
			    regsub {^# } $line &#34;&#34; line
			    regsub {^#} $line &#34;&#34; line
			    <font color="#208020"># ... and add to result</font>
			    if {[info exist resStr] == 1} {
				set resStr [format &#34;%s\n%s&#34; $resStr &#34;$line&#34;]
			    } else {
				set resStr $line
			    }
			} else {
			    <font color="#208020"># No more leading &#34;#&#34; -&gt; end of help comment.</font>
			    break
			}
		    }
		    if {[info exist resStr] != 1} {
			<font color="#208020"># There was no line beginning with &#34;#&#34; after the</font>
			<font color="#208020"># header line of the help comment.</font>
			set resStr &#34;Sorry, no help for `$cmdName'.&#34;
		    }		    
		    <font color="#208020"># Exit the loop on file lines.</font>
		    break
		}
	    }
	    close $fileId
	    set resStr [format &#34;%s\n\n(file : %s)&#34; $resStr $fileName]
	}
    } else {
	<font color="#208020"># No command name -&gt; need a general help message.</font>

	<font color="#208020"># General help on C-defined commands.</font>
	set resStr &#34;&#34;
	set resStr &#34;${resStr}* Soft help for smurf. *\n\n&#34;

	set resStr &#34;${resStr}List of C-defined commands :\n\n&#34;
	set allListOfCmds [cmdlist]
	lappend allListOfCmds [cv1d cmdlist]
	lappend allListOfCmds [cv2d cmdlist]
	set namesList [list \
		&#34;general commands (see in XSMURFDIR/tcl_library/*)&#34;\
		&#34;signal commands&#34;\
		&#34;stat commands&#34;\
		&#34;image commands&#34;\
		&#34;mathematical morphology commands (see also in XSMURFDIR/tcl_library/morphology_proc.tcl)&#34;\
		&#34;1d wavelet transform commands&#34;\
		&#34;2d wavelet transform commands&#34;\
		&#34;3d wavelet transform commands&#34;\
		&#34;files manipulation commands&#34;\
		&#34;1d convolution commands&#34;\
		&#34;2d convolution commands&#34;]

	set index 0
	foreach listOfCmds ${allListOfCmds} {
	    set resStr &#34;${resStr}* [lindex ${namesList} $index] :\n&#34;
	    set resStr &#34;${resStr}${listOfCmds}\n&#34; 
	    set resStr &#34;${resStr}\n&#34;
	    incr index
	}

	set resStr &#34;${resStr}For help on a command type :\n&#34;
	set resStr &#34;${resStr}help &lt;command_name&gt;\n&#34;
	set resStr &#34;${resStr}This displays usage and a \&#34;possibly complete help message\&#34; (that depends\n&#34;
	set resStr &#34;${resStr}on the command).\n&#34;
    }
    return $resStr
}
</pre>
<hr>
<font size="-2">
<a href="xsmurf_tcl_lib_intro.html">Overview</a> | Index by:  <a href="index_main.html#byfilename">file name</a> |
<a href="index_main.html#byprocname">procedure name</a> |
<a href="index_main.html#bycall">procedure call</a> |
<a href="index_annot_full.html">annotation</a><br>
<cite>File generated 2008-04-03 at 09:49.</cite>
</font>
</body>
</html>
