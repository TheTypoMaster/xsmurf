<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!-- Generated by TclDoc 0.3 -->
<html>
<head><title>eiFiles.tcl</title></head>
<body bgcolor="#ffffff">
<font size="-2">
<a href="xsmurf_tcl_lib_intro.html">Overview</a> | Index by:  <a href="index_main.html#eiFiles.tcl">file name</a> |
<a href="index_main.html#byprocname">procedure name</a> |
<a href="index_main.html#bycall">procedure call</a> |
<a href="index_annot_full.html">annotation</a>
</font>
<hr>
<strong>eiFiles.tcl</strong>
(<a href="eiFiles.tcl-annot.html">annotations</a> | <a href="eiFiles.tcl.txt">original source</a>)
<p>
<pre>
<font color="#208020"># eiFiles.tcl --</font>
<font color="#208020">#</font>
<font color="#208020">#       This file implements the Tcl code for ...</font>
<font color="#208020">#</font>
<font color="#208020">#   Copyright 1999 Centre de Recherche Paul Pascal, Bordeaux, France.</font>
<font color="#208020">#   Written by Nicolas Decoster.</font>
<font color="#208020">#</font>
<font color="#208020">#  RCS : $Id: eiFiles.tcl,v 1.4 1999/05/06 11:59:26 decoster Exp $</font>
<font color="#208020">#</font>

package provide eiFiles 0.0

<font color="#208020"># chains2dat --</font>
<font color="#208020"># usage: chains2dat str [... options ...]</font>
<font color="#208020">#</font>
<font color="#208020">#   From an ext image, create .dat files usable by Greg.</font>
<font color="#208020">#</font>
<font color="#208020"># Parameters:</font>
<font color="#208020">#   string - The ext image name.</font>
<font color="#208020">#</font>
<font color="#208020"># Options:</font>
<font color="#208020">#   -max: Save gradients of maxima that are on vertical chains.</font>
<font color="#208020">#      [string] - Name of the resulting file. Default is mEI.dat if EI is the</font>
<font color="#208020">#                 name of the ext image.</font>
<font color="#208020">#   -gr: Save gradients of maxima that are local maxim along a contour line.</font>
<font color="#208020">#      [string] - Name of the resulting file. Default is gEI.dat if EI is the</font>
<font color="#208020">#                 name of the ext image.</font>
<font color="#208020">#   -line: Save position of each point of each contour line.</font>
<font color="#208020">#      [string] - Name of the resulting file. Default is lEI.dat if EI is the</font>
<font color="#208020">#                 name of the ext image.</font>
<font color="#208020">#   -mult: Apply a multiplicative value to each gradient size.</font>
<font color="#208020">#      float - The value.</font>
<font color="#208020">#   -zoom: Apply a zoom to all the outputs.</font>
<font color="#208020">#      float - value of the zoom.</font>
<font color="#208020">#   -offset: Apply an offset to all positions.</font>
<font color="#208020">#      integer|list - If one value is given, take this value for x and y</font>
<font color="#208020">#                     offsets. Otherwise list of these 2 values.</font>
<font color="#208020">#   -center: Center all positions.</font>
<font color="#208020">#   -onlyposition: Used with &#34;gradient&#34; options (-max or -gr). Save only the</font>
<font color="#208020">#      position of the gradient.</font>
<font color="#208020">#</font>
<font color="#208020"># Return value:</font>
<font color="#208020">#   None.</font>

<strong><a name="chains2dat_45">proc <a href="eiFiles.tcl-annot.html#chains2dat">chains2dat</a></a></strong><a name="chains2dat"></a> {eiName args} {

    set isMax no
    set mFileName m$eiName.dat
    set isLine no
    set lFileName l$eiName.dat
    set isGr no
    set gFileName g$eiName.dat
    set mult 1
    set xOffset 0
    set yOffset 0
    set zoom 1
    set isCenter no
    set isOnlyposition no

    <font color="#208020"># Arguments analysis</font>

    while {[string match -* $args]} {
	switch -exact -- [lindex $args 0] {
	    -max {
		set isMax yes
		set nextArg [lindex $args 1]
		if {$nextArg == &#34;&#34; || [string match -* $nextArg]} {
		    set args [lreplace $args 0 0]
		} else {
		    set mFileName $nextArg
		    set args [lreplace $args 0 1]
		}
	    }
	    -line {
		set isLine yes
		set nextArg [lindex $args 1]
		if {$nextArg == &#34;&#34; || [string match -* $nextArg]} {
		    set args [lreplace $args 0 0]
		} else {
		    set lFileName $nextArg
		    set args [lreplace $args 0 1]
		}
	    }
	    -gr {
		set isGr yes
		set nextArg [lindex $args 1]
		if {$nextArg == &#34;&#34; || [string match -* $nextArg]} {
		    set args [lreplace $args 0 0]
		} else {
		    set gFileName $nextArg
		    set args [lreplace $args 0 1]
		}
	    }
	    -mult {
		set mult [lindex $args 1]
		set args [lreplace $args 0 1]
	    }
	    -offset {
		set offset [lindex $args 1]
		set args [lreplace $args 0 1]
		if {[llength $offset] == 1} {
		    set xOffset $offset
		    set yOffset $offset
		} else {
		    <a name="lassign(1)"><a href="./tools.tcl.html#lassign_67">lassign</a></a> {xOffset yOffset} $offset
		}
	    }
	    -zoom {
		set zoom [lindex $args 1]
		set args [lreplace $args 0 1]
	    }
	    -center {
		set isCenter yes
		set args [lreplace $args 0 0]
	    }
	    -onlyposition {
		set isOnlyposition yes
		set args [lreplace $args 0 0]
	    }
	    default {
		return -code error &#34;unknown option \&#34;[lindex $args 0]\&#34;&#34;
	    }
	}
    }

    <a name="lassign(2)"><a href="./tools.tcl.html#lassign_67">lassign</a></a> {scale lx ly extrNb chainNb nbOfLines stamp} [einfo $eiName]
    <a name="lassign(3)"><a href="./tools.tcl.html#lassign_67">lassign</a></a> {min max} [egetextr $eiName]

    if {$isCenter == &#34;yes&#34;} {
	set xOffset [expr { -$lx/2 }]
	set yOffset [expr { -$ly/2 }]
    }

    set mult [expr { $mult }]

    if {$isLine == &#34;yes&#34;} {
	set lFileId [open $lFileName w]

	eiloop $eiName {
	    set zex [expr { ($xOffset + $x) * $zoom }]
	    set zey [expr { ($yOffset + $y) * $zoom }]
	    puts $lFileId &#34;$zex $zey&#34;
	}

	close $lFileId
    }

    if {$isGr == &#34;yes&#34;} {
	set gFileId [open $gFileName w]
    }
    if {$isMax == &#34;yes&#34;} {
	set mFileId [open $mFileName w]
    }

    if {$isGr == &#34;yes&#34; || $isMax == &#34;yes&#34;} {
	eigrloop $eiName {
	    if {$isMax == &#34;yes&#34; &amp;&amp; $type == &#34;tag vc&#34;} {
		set zex [expr { ($xOffset + $xx) * $zoom }]
		set zey [expr { ($yOffset + $yy) * $zoom }]
		puts $mFileId &#34;$zex $zey&#34;
		if {$isOnlyposition == &#34;no&#34;} {
		    set x1 [expr $zex+$mult*$mod*cos($arg)]
		    set y1 [expr $zey+$mult*$mod*sin($arg)]
		    puts $mFileId &#34;$x1 $y1&#34;
		}
	    }
	    if {$isGr == &#34;yes&#34;} {
		set zex [expr { ($xOffset + $xx) * $zoom }]
		set zey [expr { ($yOffset + $yy) * $zoom }]
		puts $gFileId &#34;$zex $zey&#34;
		if {$isOnlyposition == &#34;no&#34;} {
		    set x1 [expr $zex+$mult*$mod*cos($arg)]
		    set y1 [expr $zey+$mult*$mod*sin($arg)]
		    puts $gFileId &#34;$x1 $y1&#34;
		}
	    }
	}
    }

    if {$isGr == &#34;yes&#34;} {
	close $gFileId
    }
    if {$isMax == &#34;yes&#34;} {
	close $mFileId
    }

    return
}

</pre>
<hr>
<font size="-2">
<a href="xsmurf_tcl_lib_intro.html">Overview</a> | Index by:  <a href="index_main.html#byfilename">file name</a> |
<a href="index_main.html#byprocname">procedure name</a> |
<a href="index_main.html#bycall">procedure call</a> |
<a href="index_annot_full.html">annotation</a><br>
<cite>File generated 2008-04-03 at 09:49.</cite>
</font>
</body>
</html>
